<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadora de Pneus Evok</title>
  <script 
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCKCV0EeLhjGGkio1-FrkBTbVBk-rP3Q74&libraries=geometry" 
    async 
    defer>
  </script>
  <style>
body {
  font-family: Arial, sans-serif;
  background-color: #f4f4f4;
  margin: 0;
  padding: 40px 0;
  display: flex;
  justify-content: center;
}

.container {
  background: white;
  padding: 30px;
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
  max-width: 600px;
  width: 100%;
  margin: auto;
}
    h1 {
      text-align: center;
      color: #333;
      margin-top: 30px;
    }
    label {
      font-weight: bold;
      margin-top: 10px;
      display: block;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin: 5px 0 15px 0;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
    }
    button {
      background-color: #007BFF;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    pre {
      background: #f0f0f0;
      padding: 15px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Calculadora de Pneus Evok</h1>

    <label><strong>Origem:</strong>
      <input type="text" id="cidadeOrigem" value="R2 Log√≠stica - Navegantes - SC">
    </label>

    <label><strong>CEP de destino:</strong>
      <input type="text" id="cepDestino" placeholder="Digite o CEP">
    </label>
    <button id="buscarCidade">Buscar Cidade</button>

    <label><strong>Cidade detectada:</strong>
      <input type="text" id="cidadeDestino" readonly>
    </label>

    <label><strong>Pneu:</strong>
      <select id="pneuSelect"></select>
    </label>

    <label><strong>Quantidade:</strong>
      <input type="number" id="quantidade" value="1">
    </label>

    <label><strong>Custo por unidade (R$):</strong>
      <input type="number" id="custoPneu" value="100">
    </label>

    <button id="btnCalcular">Calcular Frete</button>

    <h2>Resultado:</h2>
    <pre id="resultado"></pre>
  </div>

  <script>
    const pneus = {
"165/70 R13": { dimensoes: [0.549, 0.549, 0.165], peso: 6.2 },
"165/70 R14": { dimensoes: [0.58, 0.58, 0.165], peso: 7.0 },
"175/70 R13": { dimensoes: [0.575, 0.575, 0.175], peso: 6.97 },
"175/65 R14": { dimensoes: [0.6, 0.6, 0.177], peso: 6.5 },
"185/70 R14": { dimensoes: [0.615, 0.615, 0.185], peso: 7.0 },
"175/70 R14": { dimensoes: [0.6, 0.6, 0.17], peso: 6.5 },
"175/80 R14": { dimensoes: [0.63, 0.63, 0.17], peso: 8.75 },
"185 R14C": { dimensoes: [0.66, 0.66, 0.2], peso: 8.0 },
"185/65 R15": { dimensoes: [0.62, 0.62, 0.185], peso: 7.7 },
"185/65 R14": { dimensoes: [0.596, 0.596, 0.185], peso: 7.8 },
"195/55 R15": { dimensoes: [0.59, 0.59, 0.195], peso: 8.0 },
"195/60 R15": { dimensoes: [0.615, 0.615, 0.195], peso: 7.8 },
"195/65 R15": { dimensoes: [0.634, 0.634, 0.195], peso: 8.4 },
"185/60 R15": { dimensoes: [0.603, 0.603, 0.185], peso: 7.0 },
"195/55 R16": { dimensoes: [0.62, 0.62, 0.195], peso: 8.4 },
"205/60 R16": { dimensoes: [0.65, 0.65, 0.205], peso: 9.6 },
"205/60 R15": { dimensoes: [0.6, 0.6, 0.21], peso: 12.0 },
"215/75 R16": { dimensoes: [0.73, 0.73, 0.215], peso: 14.3 },
"12.5/80-18": { dimensoes: [1.0, 1.0, 0.31], peso: 40.0 },
"13.00-24": { dimensoes: [1.3, 1.3, 0.24], peso: 73.0 },
"215/65 R16": { dimensoes: [0.68, 0.68, 0.21], peso: 10.05 },
"1000-20": { dimensoes: [1.02, 1.02, 0.26], peso: 46.0 },
"215/65 R16": { dimensoes: [0.69, 0.69, 0.22], peso: 10.3 },
"265/70 R16": { dimensoes: [0.777, 0.777, 0.265], peso: 17.49 },
"215/75 R17.5": { dimensoes: [0.77, 0.77, 0.27], peso: 27.0 },
"235/75 R17.5": { dimensoes: [0.80, 0.80, 0.30], peso: 30.0 },
"275/80 R22.5": { dimensoes: [1.02, 1.02, 0.28], peso: 48.55 },
"205/75 R16": { dimensoes: [0.72, 0.72, 0.2], peso: 15.0 },
"295/80 R22.5": { dimensoes: [1.05, 1.05, 0.3], peso: 54.0 },
"205/75 R16C": { dimensoes: [0.714, 0.714, 0.205], peso: 15.7 },
"90/90-19 (Moto)": { dimensoes: [0.64, 0.64, 0.09], peso: 3.67 },
"195/70 R15": { dimensoes: [0.69, 0.69, 0.19], peso: 10.9 },
"195/75 R16": { dimensoes: [0.698, 0.698, 0.095], peso: 14.9 },
"215/80 R16": { dimensoes: [0.75, 0.75, 0.21], peso: 15.9 },
"225/65 R17": { dimensoes: [0.72, 0.72, 0.23], peso: 13.0 },
"225/65 R16C": { dimensoes: [0.7, 0.7, 0.23], peso: 15.8 },
"225/75 R16": { dimensoes: [0.74, 0.74, 0.225], peso: 17.7 },
"245/70 R16": { dimensoes: [0.75, 0.75, 0.245], peso: 15.5 },
"255/70 R16": { dimensoes: [0.75, 0.75, 0.255], peso: 17.0 },
"205/70 R15C": { dimensoes: [0.668, 0.668, 0.205], peso: 13.0 },
"900-20": { dimensoes: [0.965, 0.965, 0.228], peso: 38.2 },
"205/55 R16": { dimensoes: [0.63, 0.63, 0.205], peso: 9.0 },
"14.00-24": { dimensoes: [1.28, 1.28, 0.3], peso: 82.0 },
"12.4-24": { dimensoes: [1.23, 1.23, 0.31], peso: 49.0 },
"14.9-26": { dimensoes: [1.32, 1.32, 0.378], peso: 60.0 },
"14.9-28": { dimensoes: [1.38, 1.38, 0.378], peso: 75.58 },
"14.9-24": { dimensoes: [1.253, 1.253, 0.396], peso: 54.7 },
"19.5-24": { dimensoes: [1.308, 1.308, 0.495], peso: 86.6 },
"17.5-25": { dimensoes: [1.25, 1.25, 0.37], peso: 90.0 },
"18.4-34": { dimensoes: [1.56, 1.56, 0.47], peso: 115.0 },
"18.4-30": { dimensoes: [1.54, 1.54, 0.477], peso: 101.0 },
"12.16-5": { dimensoes: [0.715, 0.715, 0.275], peso: 35.0 },
"235/75 R15": { dimensoes: [0.734, 0.734, 0.235], peso: 14.47 },
"245/75 R16": { dimensoes: [0.774, 0.774, 0.245], peso: 16.5 },
"16.9-24": { dimensoes: [1.332, 1.332, 0.449], peso: 77.8 },
"23.1-26": { dimensoes: [1.605, 0.587, 1.605], peso: 155.95 },
"23.1-30": { dimensoes: [1.7, 1.7, 0.57], peso: 148.0 },
"10.16-5": { dimensoes: [0.92, 0.92, 0.254], peso: 28.3 },
"600-16": { dimensoes: [0.72, 0.72, 0.16], peso: 11.0 },
"700-16": { dimensoes: [0.76, 0.76, 0.18], peso: 16.8 },
"750-16": { dimensoes: [0.79, 0.79, 0.2], peso: 20.0 },
"265/70 R16": { dimensoes: [0.777, 0.777, 0.265], peso: 17.0 },
"16.9-28": { dimensoes: [1.42, 1.42, 0.43], peso: 86.0 },
"285/70 R19.5": { dimensoes: [0.89, 0.89, 0.28], peso: 62.0 },
"235/55 R18": { dimensoes: [0.72, 0.72, 0.24], peso: 19.0 },
"235/65 R16": { dimensoes: [0.76, 0.76, 0.24], peso: 16.5 },
"235/85 R16": { dimensoes: [0.81, 0.81, 0.23], peso: 20.0 },
"13.6-38": { dimensoes: [1.57, 1.57, 0.36], peso: 77.0 },
"265/65 R17": { dimensoes: [0.74, 0.74, 0.21], peso: 19.1 },
"225/70 R16": { dimensoes: [0.72, 0.72, 0.22], peso: 13.5 },
"225/55 R18": { dimensoes: [0.75, 0.75, 0.3], peso: 11.96 },
"225/60 R18": { dimensoes: [0.74, 0.74, 0.24], peso: 13.0 },
"110/90-17 (Moto)": { dimensoes: [0.635, 0.635, 0.113], peso: 4.3 },
"16.9-30": { dimensoes: [1.621, 1.621, 0.429], peso: 61.0 },
"185/60 R14": { dimensoes: [0.6, 0.6, 0.185], peso: 7.7 },
"23.5-25": { dimensoes: [1.617, 0.597, 1.617], peso: 386.0 },
"265/70 R17": { dimensoes: [0.8, 0.8, 0.265], peso: 19.0 },
"265/75 R16": { dimensoes: [0.8, 0.8, 0.26], peso: 23.0 },
"235/70 R16": { dimensoes: [0.74, 0.74, 0.235], peso: 20.0 },
"10.5/80-18": { dimensoes: [0.883, 0.883, 0.266], peso: 21.0 },
"185/70 R13": { dimensoes: [0.6, 0.6, 0.18], peso: 7.0 },
"13.00-24": { dimensoes: [1.23, 1.23, 0.74], peso: 74.0 },
"11.00-22": { dimensoes: [1.07, 1.07, 0.27], peso: 50.0 },
"265/60 R18": { dimensoes: [0.78, 0.78, 0.27], peso: 17.4 },
"205/55 R17": { dimensoes: [0.65, 0.65, 0.21], peso: 11.0 },
"12.00 R20": { dimensoes: [1.1, 1.1, 0.3], peso: 74.6 },
"750-18": { dimensoes: [0.838, 0.838, 0.19], peso: 25.0 },
"900-16": { dimensoes: [0.855, 0.855, 0.256], peso: 23.0 },
"20.5-25": { dimensoes: [1.32, 1.32, 0.5], peso: 132.0 },
"195/60 R16": { dimensoes: [0.64, 0.64, 0.19], peso: 8.6 },
    };

const tabelasFrete = {
  AC: { faixa: [{limite:30,valorKg:148.2}, {limite:50,valorKg:168.6}, {limite:70,valorKg:215.1}, {limite:100,valorKg:290.7}], valorExcedente: 2318.4, gris: 0.002, grisMin: 4.97, adVal: 0.005, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  AL: { AL1: { cidades: ["Coqueiro Seco", "Macei√≥", "Marechal Deodoro", "Pilar", "Rio Largo", "Santa Luzia do Norte", "S√£o Miguel dos Campos", "Satuba"],
    faixa: [{limite: 30, valorKg: 83.2}, {limite: 50, valorKg: 94.6}, {limite: 70, valorKg: 120.7}, {limite: 100, valorKg: 163.1}], valorExcedente: 1534.4, gris: 0.002, grisMin: 4.97, adVal: 0.004, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: { faixa: [{ limite: 30, valorKg: 118.0 },{ limite: 50, valorKg: 134.2 }, { limite: 70, valorKg: 171.2 }, { limite: 100, valorKg: 231.3 }], valorExcedente: 1971.2, gris: 0.002, grisMin: 4.97, adVal: 0.0051, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 } },
  BA: { BA1: { cidades: ["CAMACARI", "CANDEIAS", "DIAS D AVILA","LAURO DE FREITAS","MADRE DE DEUS","MATA DE SAO JOAO","SALVADOR","SAO FRANCISCO DO CONDE","SAO SEBASTIAO DO PASSE","SIMOES FILHO"],
    faixa: [{limite:30,valorKg:71.86}, {limite:50,valorKg:81.73}, {limite:70,valorKg:104.27}, {limite:100,valorKg:140.91}], valorExcedente: 1321.6, gris: 0.002, grisMin: 4.97, adVal: 0.0040, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  BA2: { cidades: ["CONDE", "FEIRA DE SANTANA", "JAGUARIPE","LAFAIETE COUTINHO","LAMARAO","MANOEL VITORINO","MARACAS","MARAGOGIPE","MILAGRES","MUNDO NOVO","MURITIBA","NOVA FATIMA","NOVA IBIA","NOVA ITARANA","OLINDINA","OURICANGAS","MILAGRES","OUROLANDIA","PAULO AFONSO","PEDRAO","PIRAI DO NORTE","PLANALTO","POCOES","POJUCA",
                   "PONTO NOVO","PRESIDENTE TANCREDO NEVES","QUIXABEIRA","RAFAEL JAMBEIRO","RIACHAO DO JACUIPE","RIBEIRA DO AMPARO","RIBEIRA DO POMBAL","RIO REAL","SALINAS DA MARGARIDA","SANTA BARBARA","SANTA BRIGIDA","SANTA INES","SANTA TERESINHA",
                   "SANTALUZ","SANTANOPOLIS","SANTO AMARO","SANTO ANTONIO DE JESUS","SANTO ESTEVAO","SAO FELIPE","SAO FELIX","SAO GABRIEL","SAO GONCALO DOS CAMPOS","SAO JOSE DO JACUIPE","SAPEACU","SERRA PRETA","SERRINHA","SERROLANDIA","SUSSUARANA","TANHACU","TANQUINHO","TEODORO SAMPAIO","TEOFILANDIA","TEOLANDIA","TERRA NOVA","TUCANO","UBAITABA","UBATA","URUCUCA","VALENCA","VALENTE","VARZEA DA ROCA","VARZEA DO POCO","VERA CRUZ","VITORIA DA CONQUISTA","WENCESLAU GUIMARAES"],
    faixa: [{limite:30,valorKg:92.67}, {limite:50,valorKg:105.39}, {limite:70,valorKg:134.46}, {limite:100,valorKg:181.7}], valorExcedente: 1545.6, gris: 0.002, grisMin: 4.97, adVal: 0.0051, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:113.47}, {limite:50,valorKg:129.04}, {limite:70,valorKg:164.64}, {limite:100,valorKg:222.49}], valorExcedente: 1892.8, gris: 0.0049, grisMin: 4.97, adVal: 0.0051, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} }, 
  CE: { CE1: { cidades: ["MARACANAU", "PINDORETAMA", "SAO JOAO DO JAGUARIBE", "AQUIRAZ", "EUSEBIO", "FORTALEZA", "ITAITINGA"],
    faixa: [{limite:30,valorKg:91.53}, {limite:50,valorKg:104.09}, {limite:70,valorKg:132.81}, {limite:100,valorKg:179.47}], valorExcedente: 1691.2, gris: 0.002, grisMin: 4.97, adVal: 0.004, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:130.8}, {limite:50,valorKg:148.8}, {limite:70,valorKg:189.8}, {limite:100,valorKg:256.5}], valorExcedente: 2049.6, gris: 0.002, grisMin: 4.97, adVal: 0.0051, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  DF: { faixa: [{limite:30,valorKg:71.8}, {limite:50,valorKg:81.7}, {limite:70,valorKg:104.2}, {limite:100,valorKg:140.9}], valorExcedente: 1075.2, gris: 0.002, grisMin: 4.97, adVal: 0.0042, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  ES: { ES1: { cidades: ["Cariacica", "Serra", "Vit√≥ria", "Viana", "Vila Velha", "Vit√≥ria"],
    faixa: [{limite:30,valorKg:64.9}, {limite:50,valorKg:73.8}, {limite:70,valorKg:94.1}, {limite:100,valorKg:127.2}], valorExcedente: 1052.8, gris: 0.002, grisMin: 4.97, adVal: 0.0035, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:76.71}, {limite:50,valorKg:87.24}, {limite:70,valorKg:111.29}, {limite:100,valorKg:150.3}], valorExcedente: 1366.4, gris: 0.0049, grisMin: 4.97, adVal: 0.0051, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  GO: { GO1: { cidades: ["Aparecida de Goi√¢nia", "Goi√¢nia", "Hidrol√¢ndia"],
    faixa: [{limite:30,valorKg:64.9}, {limite:50,valorKg:73.8}, {limite:70,valorKg:94.1}, {limite:100,valorKg:127.2}], valorExcedente: 1075.2, gris: 0.002, grisMin: 4.97, adVal: 0.0035, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:76.7}, {limite:50,valorKg:87.2}, {limite:70,valorKg:111.2}, {limite:100,valorKg:150.3}], valorExcedente: 1276.8, gris: 0.0049, grisMin: 4.97, adVal: 0.0051, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  MA: { MA1: { cidades: ["Alcantara", "Bacabeira", "PACO DO LUMIAR","Raposa","Rosario","Santa Rita","SAO JOSE DE RIBAMAR","SAO LUIS"],
    faixa: [{limite:30,valorKg:105.15}, {limite:50,valorKg:119.58}, {limite:70,valorKg:152.57}, {limite:100,valorKg:206.17}], valorExcedente: 1915.2, gris: 0.002, grisMin: 4.97, adVal: 0.0046, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:148.27}, {limite:50,valorKg:168.6}, {limite:70,valorKg:215.13}, {limite:100,valorKg:290.71}], valorExcedente: 2318.4, gris: 0.0049, grisMin: 4.97, adVal: 0.0057, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },  
  MS: { faixa: [{limite:30,valorKg:85.4}, {limite:50,valorKg:97.2}, {limite:70,valorKg:124.0}, {limite:100,valorKg:167.6}], valorExcedente: 1579.2, gris: 0.002, grisMin: 4.97, adVal: 0.0045, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  MT: { faixa: [{limite:30,valorKg:113.4}, {limite:50,valorKg:129.0}, {limite:70,valorKg:164.6}, {limite:100,valorKg:222.4}], valorExcedente: 1960.0, gris: 0.002, grisMin: 4.97, adVal: 0.005, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  PI: { PI1: { cidades: ["Altos", "BENEDITINOS", "COIVARAS", "CURRALINHOS", "JOSE DE FREITAS", "LAGOA ALEGRE","LAGOA DO PIAUI", "MONSENHOR GIL", "TERESINA", "UNIAO"],
    faixa: [{limite:30,valorKg:105.1}, {limite:50,valorKg:119.5}, {limite:70,valorKg:152.5}, {limite:100,valorKg:206.1}], valorExcedente: 1915.2, gris: 0.002, grisMin: 4.97, adVal: 0.0046, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:148.2}, {limite:50,valorKg:168.6}, {limite:70,valorKg:215.1}, {limite:100,valorKg:290.7}], valorExcedente: 2318.4, gris: 0.0049, grisMin: 4.97, adVal: 0.0057, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  PA: { PA1: { cidades: ["BELEM"],
    faixa: [{limite:30,valorKg:99.1}, {limite:50,valorKg:112.69}, {limite:70,valorKg:143.79}, {limite:100,valorKg:194.3}], valorExcedente: 1713.6, gris: 0.002, grisMin: 4.97, adVal: 0.0051, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  PA2: { cidades: ["BENEVIDES", "MARITUBA", "SANTA BARBARA DO PARA","SANTA IZABEL DO PARA","ANANINDEUA"],
    faixa: [{limite:30,valorKg:125.57}, {limite:50,valorKg:142.8}, {limite:70,valorKg:182.2}, {limite:100,valorKg:246.21}], valorExcedente: 1971.2, gris: 0.002, grisMin: 4.97, adVal: 0.0057, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:139.94}, {limite:50,valorKg:159.15}, {limite:70,valorKg:203.06}, {limite:100,valorKg:274.40}], valorExcedente: 2094.4, gris: 0.0049, grisMin: 4.97, adVal: 0.0068, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  MG: { MG1: { cidades: ["BELO HORIZONTE", "BETIM", "CONTAGEM","IBIRITE","NOVA LIMA","RAPOSOS","RIBEIRAO DAS NEVES","RIO ACIMA","SABARA","VESPASIANO"],
    faixa: [{limite:30,valorKg:64.9}, {limite:50,valorKg:73.81}, {limite:70,valorKg:94.17}, {limite:100,valorKg:127.27}], valorExcedente: 1008.0, gris: 0.002, grisMin: 4.97, adVal: 0.0035, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  MG2: { cidades: ["BRUMADINHO", "IGARAPE", "JUIZ DE FORA","MARIO CAMPOS","OURO FINO","POUSO ALEGRE","SANTA LUZIA","SARZEDO","SETE LAGOAS","UBERLANDIA"],
    faixa: [{limite:30,valorKg:71.86}, {limite:50,valorKg:81.73}, {limite:70,valorKg:104.27}, {limite:100,valorKg:140.91}], valorExcedente: 1075.2, gris: 0.002, grisMin: 4.97, adVal: 0.0049, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:76.71}, {limite:50,valorKg:87.24}, {limite:70,valorKg:111.29}, {limite:100,valorKg:150.39}], valorExcedente: 1243.2, gris: 0.0049, grisMin: 4.97, adVal: 0.0049, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  PB: { PB1: { cidades: ["LUCENA", "MAMANGUAPE", "MARI", "MULUNGU", "RIO TINTO", "SANTA RITA","ALHANDRA", "BAYEUX", "CAAPORA", "CABEDELO","CONDE", "CRUZ DO ESPIRITO SANTO","ITABAIANA", "ITATUBA", "JOAO PESSOA"],
    faixa: [{limite:30,valorKg:90.0}, {limite:50,valorKg:102.0}, {limite:70,valorKg:130.6}, {limite:100,valorKg:176.5}], valorExcedente: 1657.6, gris: 0.002, grisMin: 4.97, adVal: 0.004, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:120.2}, {limite:50,valorKg:136.7}, {limite:70,valorKg:174.5}, {limite:100,valorKg:235.8}], valorExcedente: 2016.0, gris: 0.0049, grisMin: 4.97, adVal: 0.0051, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  RN: { faixa: [{limite:30,valorKg:90.01}, {limite:50,valorKg:102.37}, {limite:70,valorKg:130.61}, {limite:100,valorKg:176.5}], valorExcedente: 1657.6, gris: 0.002, grisMin: 4.97, adVal: 0.004, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  PE: { PE1: { cidades: ["MORENO", "OLINDA", "PAULISTA", "RECIFE", "SAO LOURENCO DA MATA", "ABREU E LIMA","ALAGOINHA", "ALTINHO", "CABO DE SANTO AGOSTINHO", "CAMARAGIBE","IGARASSU", "IPOJUCA","ITAPISSUMA", "JABOATAO DOS GUARARAPES"],
    faixa: [{limite:30,valorKg:85.48}, {limite:50,valorKg:97.22}, {limite:70,valorKg:124.03}, {limite:100,valorKg:167.61}], valorExcedente: 1579.2, gris: 0.002, grisMin: 4.97, adVal: 0.004, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:118.0}, {limite:50,valorKg:134.2}, {limite:70,valorKg:171.2}, {limite:100,valorKg:231.3}], valorExcedente: 1982.4, gris: 0.0049, grisMin: 4.97, adVal: 0.0051, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  PR: { PR1: { cidades: ["RIO BRANCO DO SUL","SAO JOSE DOS PINHAIS", "ALMIRANTE TAMANDARE", "ARAUCARIA","BALSA NOVA","BOCAIUVA DO SUL","CAMPINA GRANDE DO SUL", "CAMPO LARGO", "CAMPO MAGRO","CARAMBEI","COLOMBO", "CURITIBA","FAZENDA RIO GRANDE","MANDIRITUBA","PINHAIS","PIRAQUARA","QUATRO BARRAS"],
    faixa: [{limite:30,valorKg:48.55}, {limite:50,valorKg:55.2},{limite:70,valorKg:70.44},{limite:100,valorKg:95.19}], valorExcedente: 560.0, gris: 0.002, grisMin: 4.97, adVal: 0.0035, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  PR2: { cidades: ["BENEVIDES", "MARITUBA", "SANTA BARBARA DO PARA","SANTA IZABEL DO PARA","ANANINDEUA"],
    faixa: [{limite:30,valorKg:53.7}, {limite:50,valorKg:61.1},{limite:70,valorKg:78.0},{limite:100,valorKg:105.3}], valorExcedente: 806.4, gris: 0.002, grisMin: 4.97, adVal: 0.0049, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:58.9}, {limite:50,valorKg:67.0},{limite:70,valorKg:87.7},{limite:100,valorKg:115.6}], valorExcedente: 1019.2, gris: 0.002, grisMin: 4.97, adVal: 0.0049, gris: 0.0049, grisMin: 4.97, adVal: 0.0068, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  RJ: { RJ1: { cidades: ["MESQUITA", "NILOPOLIS", "NITEROI", "NOVA IGUACU", "RIO DE JANEIRO", "SAO JOAO DE MERITI", "BELFORD ROXO", "ITABORAI"],
    faixa: [{limite:30,valorKg:57.12}, {limite:50,valorKg:64.95}, {limite:70,valorKg:82.87}, {limite:100,valorKg:111.99}], valorExcedente: 985.6, gris: 0.002, grisMin: 4.97, adVal: 0.0035, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:63.24}, {limite:50,valorKg:71.92}, {limite:70,valorKg:91.76}, {limite:100,valorKg:124.0}], valorExcedente: 1243.2, gris: 0.0049, grisMin: 4.97, adVal: 0.0051, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  RO: { faixa: [{limite:30,valorKg:75.0}, {limite:50,valorKg:80.0}, {limite:70,valorKg:90.0}, {limite:100,valorKg:110.0}], valorExcedente: 1500.0, gris: 0.002, grisMin: 4.97, adVal: 0.0045, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  RS: { RS1: { cidades: ["ALVORADA", "CACHOEIRINHA", "CAMPO BOM","CANOAS","DOIS IRMAOS","ESTEIO","GRAVATAI","GUAIBA","NOVA SANTA RITA","NOVO HAMBURGO","PORTO ALEGRE","SAO LEOPOLDO","SAPUCAIA DO SUL","VIAMAO"],
    faixa: [{limite:30,valorKg:58.96}, {limite:50,valorKg:67.0}, {limite:70,valorKg:85.5}, {limite:100,valorKg:115.6}], valorExcedente: 851.2, gris: 0.002, grisMin: 4.97, adVal: 0.0035, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  RS2: { cidades: ["ALTO FELIZ", "ANDRE DA ROCHA", "ANTONIO PRADO", "ARROIO DO SAL", "ARROIO DO TIGRE","ARVOREZINHA", "BALNEARIO PINHAL", "BARAO", "BARROS CASSAL", "BENTO GONCALVES",
    "BOA VISTA DO SUL", "BOM JESUS", "BOM PRINCIPIO", "ARROIO DO MEIO", "BOM RETIRO DO SUL", "BOQUEIRAO DO LEAO", "BROCHIER", "CAMBARA DO SUL", "CAMPESTRE DA SERRA", "CANDELARIA",
    "CANELA", "CANUDOS DO", "CAPAO BONITO DO SUL", "CAPAO DA CANOA", "CAPELA DE SANTANA", "CAPITAO", "CAPIVARI DO SUL", "CARAA", "CARLOS BARBOSA", "CASCA", "CASEIROS", "CAXIAS DO SUL", "CIDREIRA", "CIRIACO", "COLINAS",
    "COQUEIRO BAIXO", "CORONEL PILAR", "COTIPORA", "CRUZEIRO DO SUL", "TRAMANDAI", "DAVID CANABARRO", "DOM PEDRO DE ALCANTARA", "DOUTOR RICARDO", "ENCANTADO", "ENCRUZILHADA DO SUL", "ESMERALDA", "ESTANCIA VELHA", "ESTRELA", "FAGUNDES VARELA", "FARROUPILHA",
    "FAZENDA VILANOVA", "FELIZ", "FLORES DA CUNHA", "FONTOURA XAVIER", "FORQUETINHA", "GARIBALDI", "GENTIL", "GLORINHA", "GRAMADO", "GRAMADO XAVIER", "GUABIJU", "GUAPORE", "HARMONIA", "HERVEIRAS", "IBARAMA",
    "IBIRAIARAS", "IGREJINHA", "ILOPOLIS", "IMIGRANTE", "IPE", "ITAPUCA", "ITATI", "JAQUIRANA", "LAGOA BONITA DO SUL", "LAGOA VERMELHA", "LAGOAO", "LAJEADO", "LINHA NOVA", "MAMPITUBA", "MAQUINE",
    "MARATA", "MARQUES DE SOUZA", "MONTAURI", "MONTE BELO DO SUL", "MONTENEGRO", "MORRINHOS DO SUL", "MOSTARDAS", "MUCUM", "MUITOS CAPOES", "MULITERNO", "OSORIO", "PALMARES DO SUL", "PANTANO GRANDE", "PARAI", "PARECI",
    "PAROBE", "PASSA SETE", "PASSO DO SOBRADO", "PAVERAMA", "PICADA CAFE", "PINHAL DA SERRA", "PINTO BANDEIRA", "POUSO NOVO", "PROGRESSO", "PROTASIO ALVES", "PUTINGA", "RELVADO", "RIO PARDO", "RIOZINHO", "ROLANTE",
    "SALTO DO JACUI", "SALVADOR DO SUL", "SANTA TEREZA", "SANTA CLARA DO SUL", "SANTO ANTONIO DA PATRULHA", "SANTO ANTONIO DO PALMA", "SAO VALENTIM", "SAO FRANCISCO DE PAULA", "SAO JORGE", "SAO MARCOS", "SAO PEDRO DA SERRA", "SAO SEBASTIAO DO CAI", "SAO VALENTIM DO SUL", "SAO VENDELINO", "SEGREDO",
    "SERAFINA CORREA", "SERIO", "SINIMBU", "SOBRADINHO", "TABAI", "TAQUARA", "TAVARES", "TERRA DE AREIA", "TEUTONIA", "TORRES", "TRAVESSEIRO", "TRIUNFO", "TUNAS", "TUPANDI", "UNIAO DA SERRA",
    "VACARIA", "VANINI", "VENANCIO AIRES", "VERANOPOLIS", "VESPASIANO CORREA", "VISTA ALEGRE DO PRATA", "WESTFALIA", "XANGRI-LA"],
  faixa: [{limite:30,valorKg:71.8}, {limite:50,valorKg:81.7}, {limite:70,valorKg:104.2}, {limite:100,valorKg:140.9}], valorExcedente: 996.8, gris: 0.002, grisMin: 4.97, adVal: 0.0035, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:76.7}, {limite:50,valorKg:87.24}, {limite:70,valorKg:111.29}, {limite:100,valorKg:150.39}], valorExcedente: 1243.2, gris: 0.0049, grisMin: 4.97, adVal: 0.0049, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  SC: { SC1: { cidades: ["BARRA VELHA", "BLUMENAU", "FLORIANOPOLIS","JOINVILLE"],
    faixa: [{limite:30,valorKg:53.75}, {limite:50,valorKg:61.1}, {limite:70,valorKg:77.8}, {limite:100,valorKg:105.3}], valorExcedente: 582.4, gris: 0.002, grisMin: 4.97, adVal: 0.0035, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  SC2: { cidades: ["BRUMADINHO", "IGARAPE", "JUIZ DE FORA","MARIO CAMPOS","OURO FINO","POUSO ALEGRE","SANTA LUZIA","SARZEDO","SETE LAGOAS","UBERLANDIA"],
    faixa: [{limite:30,valorKg:58.9}, {limite:50,valorKg:67.0}, {limite:70,valorKg:85.5}, {limite:100,valorKg:115.6}], valorExcedente: 884.8, gris: 0.002, grisMin: 4.97, adVal: 0.0035, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:64.9}, {limite:50,valorKg:73.8}, {limite:70,valorKg:94.1}, {limite:100,valorKg:127.2}], valorExcedente: 1008.0, gris: 0.0049, grisMin: 4.97, adVal: 0.0049, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  SE: { SE1: { cidades: ["MALHADOR", "NOSSA SENHORA DO SOCORRO", "SANTA ROSA DE LIMA", "SANTO AMARO DAS BROTAS", "SAO CRISTOVAO", "SIRIRI","ARACAJU", "BARRA DOS COQUEIROS", "DIVINA PASTORA", "GENERAL MAYNARD"],
  faixa: [{limite:30,valorKg:80.18}, {limite:50,valorKg:91.19}, {limite:70,valorKg:116.35}, {limite:100,valorKg:157.23}], valorExcedente: 1478.4, gris: 0.002, grisMin: 4.97, adVal: 0.004, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  default: {  faixa: [{limite:30,valorKg:113.47}, {limite:50,valorKg:129.04}, {limite:70,valorKg:164.64}, {limite:100,valorKg:222.49}], valorExcedente: 1780.8, gris: 0.0049, grisMin: 4.97, adVal: 0.0051, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69} },
  SP: { faixa: [{limite:30,valorKg:58.9}, {limite:50,valorKg:67.0}, {limite:70,valorKg:85.5}, {limite:100,valorKg:115.6}], valorExcedente: 1220.8, gris: 0.002, grisMin: 4.97, adVal: 0.004, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  SP: { faixa: [{limite:30,valorKg:71.8}, {limite:50,valorKg:81.7}, {limite:70,valorKg:104.2}, {limite:100,valorKg:140.9}], valorExcedente: 1321.6, gris: 0.002, grisMin: 4.97, adVal: 0.004, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  SP: { faixa: [{limite:30,valorKg:76.7}, {limite:50,valorKg:87.2}, {limite:70,valorKg:111.2}, {limite:100,valorKg:150.3}], valorExcedente: 1411.2, gris: 0.002, grisMin: 4.97, adVal: 0.004, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  SP: { faixa: [{limite:30,valorKg:48.5}, {limite:50,valorKg:55.2}, {limite:70,valorKg:70.4}, {limite:100,valorKg:95.1}], valorExcedente: 784.0, gris: 0.002, grisMin: 4.97, adVal: 0.004, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  SP: { faixa: [{limite:30,valorKg:95.0}, {limite:50,valorKg:108.1}, {limite:70,valorKg:137.9}, {limite:100,valorKg:186.4}], valorExcedente: 1758.4, gris: 0.002, grisMin: 4.97, adVal: 0.004, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  SP: { faixa: [{limite:30,valorKg:53.7}, {limite:50,valorKg:61.1}, {limite:70,valorKg:78.0}, {limite:100,valorKg:105.4}], valorExcedente: 896.0, gris: 0.002, grisMin: 4.97, adVal: 0.004, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  TO: { faixa: [{limite:30,valorKg:118.0}, {limite:50,valorKg:134.2}, {limite:70,valorKg:171.2}, {limite:100,valorKg:231.3}], valorExcedente: 1982.4, gris: 0.002, grisMin: 4.97, adVal: 0.0045, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  TO: { faixa: [{limite:30,valorKg:85.4}, {limite:50,valorKg:97.2}, {limite:70,valorKg:124.0}, {limite:100,valorKg:167.6}], valorExcedente: 1579.2, gris: 0.002, grisMin: 4.97, adVal: 0.0045, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 },
  TO: { faixa: [{limite:30,valorKg:101.7}, {limite:50,valorKg:115.7}, {limite:70,valorKg:147.6}, {limite:100,valorKg:234.7}], valorExcedente: 1713.6, gris: 0.002, grisMin: 4.97, adVal: 0.0045, trt: 82, tas: 4.7, despacho: 17.45, pedagioPor100Kg: 4.69 }
};

 const selectPneu = document.getElementById('pneuSelect');

Object.keys(pneus)
  .sort((a, b) => a.localeCompare(b, undefined, { numeric: true }))
  .forEach(modelo => {
    const option = document.createElement('option');
    option.value = modelo;
    option.textContent = modelo;
    selectPneu.appendChild(option);
  });

    function consultarCEP() {
      const cep = document.getElementById('cepDestino').value.replace(/\D/g, '');
      fetch(`https://viacep.com.br/ws/${cep}/json/`)
        .then(res => res.json())
        .then(data => {
          if (data.erro) {
            document.getElementById('cidadeDestino').value = 'CEP inv√°lido';
          } else {
            document.getElementById('cidadeDestino').value = `${data.localidade} - ${data.uf}`;
          }
        })
        .catch(() => {
          document.getElementById('cidadeDestino').value = 'Erro ao buscar CEP';
        });
    }

   function calcularFrete() {
  const origem = document.getElementById('cidadeOrigem').value;
  const destino = document.getElementById('cidadeDestino').value;
  const modelo = document.getElementById('pneuSelect').value;
  const qtd = parseInt(document.getElementById('quantidade').value);
  const custoUnitario = parseFloat(document.getElementById('custoPneu').value);
  const resultado = document.getElementById('resultado');

  if (!modelo || !pneus[modelo] || !destino || isNaN(qtd) || isNaN(custoUnitario)) {
    resultado.innerHTML = 'Preencha todos os campos corretamente.';
    return;
  }

  const pneu = pneus[modelo];
  const pesoTotal = pneu.peso * qtd;
  const volume = pneu.dimensoes.reduce((a, b) => a * b, 1) * qtd;
  const pesoCubado = volume * 300;
  const pesoConsiderado = Math.max(pesoTotal, pesoCubado);

  // Determina o estado do destino
  const estadoDestino = destino.split(' - ')[1]?.trim().toUpperCase();
  let tabela = tabelasFrete[estadoDestino];
     
  // üëâ Fun√ß√£o para normalizar (remove acentos, deixa min√∫sculo)
const normalize = str => str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();

  // Se for Alagoas, checa se √© AL1
  if (estadoDestino === 'AL' && tabelasFrete.AL?.AL1) {
    const cidade = destino.split(' - ')[0].trim().toLowerCase();
    const match = tabelasFrete.AL.AL1.cidades.find(c => cidade === c.toLowerCase());
    tabela = match ? tabelasFrete.AL.AL1 : tabelasFrete.AL.default;
  }
     // Se for Espirito Santo, checa se √© E1
if (estadoDestino === 'ES' && tabelasFrete.ES?.ES1) {
  const cidade = destino.split(' - ')[0].trim().toLowerCase();
  const match = tabelasFrete.ES.ES1.cidades.find(c => cidade === c.toLowerCase());
  tabela = match ? tabelasFrete.ES.ES1 : tabelasFrete.ES.default;
}
     // Se for Goias, checa se √© GO1
if (estadoDestino === 'GO' && tabelasFrete.GO?.GO1) {
  const cidade = destino.split(' - ')[0].trim().toLowerCase();
  const match = tabelasFrete.GO.GO1.cidades.find(c => cidade === c.toLowerCase());
  tabela = match ? tabelasFrete.GO.GO1 : tabelasFrete.GO.default;
}
     // Se for Maranhao, checa se √© MA1
if (estadoDestino === 'MA' && tabelasFrete.MA?.MA1) {
  const cidade = destino.split(' - ')[0].trim().toLowerCase();
  const match = tabelasFrete.MA.MA1.cidades.find(c => cidade === c.toLowerCase());
  tabela = match ? tabelasFrete.MA.MA1 : tabelasFrete.MA.default;
}
      // Se for Piaui, checa se √© PI1
if (estadoDestino === 'PI' && tabelasFrete.PI?.PI1) {
  const cidade = destino.split(' - ')[0].trim().toLowerCase();
  const match = tabelasFrete.PI.PI1.cidades.find(c => cidade === c.toLowerCase());
  tabela = match ? tabelasFrete.PI.PI1 : tabelasFrete.PI.default;
}
          // Se for Ceara, checa se √© CE1
if (estadoDestino === 'CE' && tabelasFrete.CE?.CE1) {
  const cidade = destino.split(' - ')[0].trim().toLowerCase();
  const match = tabelasFrete.CE.CE1.cidades.find(c => cidade === c.toLowerCase());
  tabela = match ? tabelasFrete.CE.CE1 : tabelasFrete.CE.default;
}
      // Se for Ceara, checa se √© PE1
if (estadoDestino === 'PE' && tabelasFrete.PE?.PE1) {
  const cidade = destino.split(' - ')[0].trim().toLowerCase();
  const match = tabelasFrete.PE.PE1.cidades.find(c => cidade === c.toLowerCase());
  tabela = match ? tabelasFrete.PE.PE1 : tabelasFrete.PE.default;
}
        // Se for Paraiba, checa se √© PB1
if (estadoDestino === 'PB' && tabelasFrete.PB?.PB1) {
  const cidade = destino.split(' - ')[0].trim().toLowerCase();
  const match = tabelasFrete.PB.PB1.cidades.find(c => cidade === c.toLowerCase());
  tabela = match ? tabelasFrete.PB.PB1 : tabelasFrete.PB.default;
}
      // Se for Sergipe, checa se √© SE1
if (estadoDestino === 'SE' && tabelasFrete.SE?.SE1) {
  const cidade = destino.split(' - ')[0].trim().toLowerCase();
  const match = tabelasFrete.SE.SE1.cidades.find(c => cidade === c.toLowerCase());
  tabela = match ? tabelasFrete.SE.SE1 : tabelasFrete.SE.default;
}
      // Se for Rio de Janeiro, checa se √© RJ1
if (estadoDestino === 'RJ' && tabelasFrete.RJ?.RJ1) {
  const cidade = destino.split(' - ')[0].trim().toLowerCase();
  const match = tabelasFrete.RJ.RJ1.cidades.find(c => cidade === c.toLowerCase());
  tabela = match ? tabelasFrete.RJ.RJ1 : tabelasFrete.RJ.default;
}
     // Se for Minas Gerais, checa se √© MG1
if (estadoDestino === 'MG' && tabelasFrete.MG?.MG1 && tabelasFrete.MG?.MG2) {
  const cidade = normalize(destino.split(' - ')[0]);
  const matchMG1 = tabelasFrete.MG.MG1.cidades.find(c => normalize(c) === cidade);
  const matchMG2 = tabelasFrete.MG.MG2.cidades.find(c => normalize(c) === cidade);

  if (matchMG1) {
    tabela = tabelasFrete.MG.MG1;
  } else if (matchMG2) {
    tabela = tabelasFrete.MG.MG2;
  } else {
    tabela = tabelasFrete.MG.default;
  }
}

      // Se for Para, checa se √© PA1
if (estadoDestino === 'PA' && tabelasFrete.PA?.PA1 && tabelasFrete.PA?.PA2) {
  const cidade = normalize(destino.split(' - ')[0]);
  const matchPA1 = tabelasFrete.PA.PA1.cidades.find(c => normalize(c) === cidade);
  const matchPA2 = tabelasFrete.PA.PA2.cidades.find(c => normalize(c) === cidade);

  if (matchPA1) {
    tabela = tabelasFrete.PA.PA1;
  } else if (matchPA2) {
    tabela = tabelasFrete.PA.PA2;
  } else {
    tabela = tabelasFrete.PA.default;
  }
}

     // Se for Bahia, checa se √© BA1
if (estadoDestino === 'BA' && tabelasFrete.BA?.BA1 && tabelasFrete.BA?.BA2) {
  const cidade = normalize(destino.split(' - ')[0]);
  const matchBA1 = tabelasFrete.BA.BA1.cidades.find(c => normalize(c) === cidade);
  const matchBA2 = tabelasFrete.BA.BA2.cidades.find(c => normalize(c) === cidade);

  if (matchBA1) {
    tabela = tabelasFrete.BA.BA1;
  } else if (matchBA2) {
    tabela = tabelasFrete.BA.BA2;
  } else {
    tabela = tabelasFrete.BA.default;
  }
}
     // Se for Rio Grande do Sul, checa se √© RS1
if (estadoDestino === 'RS' && tabelasFrete.RS?.RS1 && tabelasFrete.RS?.RS2) {
  const cidade = normalize(destino.split(' - ')[0]);
  const matchRS1 = tabelasFrete.RS.RS1.cidades.find(c => normalize(c) === cidade);
  const matchRS2 = tabelasFrete.RS.RS2.cidades.find(c => normalize(c) === cidade);

  if (matchRS1) {
    tabela = tabelasFrete.RS.RS1;
  } else if (matchRS2) {
    tabela = tabelasFrete.RS.RS2;
  } else {
    tabela = tabelasFrete.RS.default;
  }
}
     // Se for Parana, checa se √© PR1
if (estadoDestino === 'PR' && tabelasFrete.PR?.PR1 && tabelasFrete.PR?.PR2) {
  const cidade = normalize(destino.split(' - ')[0]);
  const matchPR1 = tabelasFrete.PR.PR1.cidades.find(c => normalize(c) === cidade);
  const matchPR2 = tabelasFrete.PR.PR2.cidades.find(c => normalize(c) === cidade);

  if (matchPR1) {
    tabela = tabelasFrete.PR.PR1;
  } else if (matchPR2) {
    tabela = tabelasFrete.PR.PR2;
  } else {
    tabela = tabelasFrete.PR.default;
  }
}
     // Se for Santa Catarina, checa se √© SC1
if (estadoDestino === 'SC' && tabelasFrete.SC?.SC1 && tabelasFrete.SC?.SC2) {
  const cidade = normalize(destino.split(' - ')[0]);
  const matchSC1 = tabelasFrete.SC.SC1.cidades.find(c => normalize(c) === cidade);
  const matchSC2 = tabelasFrete.SC.SC2.cidades.find(c => normalize(c) === cidade);

  if (matchSC1) {
    tabela = tabelasFrete.SC.SC1;
  } else if (matchSC2) {
    tabela = tabelasFrete.SC.SC2;
  } else {
    tabela = tabelasFrete.SC.default;
  }
}
     
  if (!tabela) {
    resultado.innerHTML = 'Tabela de frete n√£o encontrada para o estado.';
    return;
  }

  // üü° CALCULA FRETE PESO
  let fretePeso = 0;
  const excedentePorKg = tabela.valorExcedente / 1000;

  for (const faixa of tabela.faixa) {
    if (pesoConsiderado <= faixa.limite) {
      fretePeso = faixa.valorKg; // Faixa com valor fixo
      break;
    }
  }

  if (fretePeso === 0) {
    fretePeso = pesoConsiderado * excedentePorKg;
  }

  // üí∞ CUSTOS
  const valorNota = custoUnitario * qtd;

  const adValorem = valorNota * tabela.adVal;
  const grisPercentual = valorNota * (tabela.gris || 0.002);
  const gris = Math.max(tabela.grisMin || 4.97, grisPercentual);

  const despacho = tabela.despacho || 17.45;
  const tas = tabela.tas || 4.7;
  const pedagio = (tabela.pedagioPor100Kg || 4.69) * Math.ceil(pesoConsiderado / 100);

  const freteTotal = fretePeso + adValorem + gris + despacho + tas + pedagio;

  // üßæ RESULTADO
  resultado.innerHTML = `
    <strong>Modelo:</strong> ${modelo}<br>
    <strong>Origem:</strong> ${origem}<br>
    <strong>Destino:</strong> ${destino}<br>
    <strong>Quantidade:</strong> ${qtd}<br>
    <strong>Peso real total:</strong> ${pesoTotal.toFixed(2)} kg<br>
    <strong>Peso cubado:</strong> ${pesoCubado.toFixed(2)} kg<br>
    <strong>Peso considerado:</strong> ${pesoConsiderado.toFixed(2)} kg<br><br>

    <strong>Frete Peso:</strong> R$ ${fretePeso.toFixed(2)}<br>
    <strong>Ad Valorem (${(tabela.adVal * 100).toFixed(2)}%):</strong> R$ ${adValorem.toFixed(2)}<br>
    <strong>GRIS (m√≠n R$ ${tabela.grisMin.toFixed(2)}):</strong> R$ ${gris.toFixed(2)}<br>
    <strong>Despacho:</strong> R$ ${despacho.toFixed(2)}<br>
    <strong>TAS:</strong> R$ ${tas.toFixed(2)}<br>
    <strong>Ped√°gio:</strong> R$ ${pedagio.toFixed(2)}<br><br>
    <strong>Frete unit√°rio:</strong> <span style="color: red; font-weight: bold;">R$ ${(freteTotal / qtd).toFixed(2)}</span><br>

    <strong><u>Frete Total:</u></strong> <strong>R$ ${freteTotal.toFixed(2)}</strong>
  `;
}

    window.onload = function () {
      document.getElementById('cepDestino').addEventListener('blur', consultarCEP);
      document.getElementById('buscarCidade').addEventListener('click', consultarCEP);
      document.getElementById('btnCalcular').addEventListener('click', calcularFrete);
    };
  </script>
</body>
</html>
