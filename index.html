<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Calculadora de Frete de Pneus</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    label, input, select, button {
      display: block;
      margin-top: 10px;
      width: 100%;
    }
    button {
      padding: 10px;
      margin-top: 20px;
    }
    .resultado {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #ccc;
    }
  </style>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCBqlyrFEKa5_ePhYx5uZv-_BLp0GUmrxI"></script>
</head>
<body>
  <h2>Calculadora de Frete de Pneus</h2>

  <label for="medida">Selecione a Medida do Pneu:</label>
  <select id="medida">
    <option value="">-- Escolha uma medida --</option>
    <option>145/80R13</option>
    <option>175/70R13</option>
    <option>195/80R13</option>
    <option>175/70R14</option>
    <option>185/60R14</option>
    <option>205/70R14</option>
    <option>185/60R15</option>
    <option>195/65R15</option>
    <option>205/60R15</option>
  </select>

  <label for="origem">CEP de Origem:</label>
  <input type="text" id="origem" placeholder="00000000" maxlength="9">

  <label for="destino">CEP de Destino:</label>
  <input type="text" id="destino" placeholder="00000000" maxlength="9">

  <button id="btnCalcular">Calcular Frete</button>

  <div class="resultado" id="resultado"></div>

  <script>
    function formatarCEP(cep) {
      return cep.replace(/[^0-9]/g, '') + ', Brasil';
    }

    function calcularDistanciaReal(origem, destino, callback) {
      const service = new google.maps.DistanceMatrixService();
      service.getDistanceMatrix({
        origins: [formatarCEP(origem)],
        destinations: [formatarCEP(destino)],
        travelMode: 'DRIVING',
        unitSystem: google.maps.UnitSystem.METRIC,
      }, function(response, status) {
        if (status === 'OK') {
          const elemento = response.rows[0].elements[0];
          if (elemento.status === 'OK') {
            const distanceKm = elemento.distance.value / 1000;
            callback(null, distanceKm);
          } else {
            callback('Distância não encontrada.', null);
          }
        } else {
          callback('Erro na API: ' + status, null);
        }
      });
    }

    function calcularFrete() {
      const medida = document.getElementById('medida').value;
      const origem = document.getElementById('origem').value;
      const destino = document.getElementById('destino').value;
      const resultado = document.getElementById('resultado');

      if (!medida || !origem || !destino) {
        resultado.innerHTML = 'Por favor, preencha todos os campos.';
        return;
      }

      const match = medida.match(/(\d{3})\/(\d{2})R(\d{2})/);
      if (!match) {
        resultado.innerHTML = 'Medida inválida.';
        return;
      }

      const largura = parseInt(match[1]);
      const perfil = parseInt(match[2]);
      const aro = parseInt(match[3]);

      const altura = (largura * (perfil / 100));
      const diametroTotal = ((2 * altura) + (aro * 25.4)) / 10;
      const larguraCm = largura / 10;

      const volume = Math.PI * Math.pow((diametroTotal / 2), 2) * larguraCm / 1000;
      const pesoEstimado = largura * 0.02;
      const pesoCubado = (diametroTotal * diametroTotal * larguraCm) / 6000;
      const pesoParaCobranca = Math.max(pesoEstimado, pesoCubado);

      calcularDistanciaReal(origem, destino, function(erro, distancia) {
        if (erro) {
          resultado.innerHTML = '<strong>Erro:</strong> ' + erro;
          return;
        }

        const taxaPorKm = 0.03;
        const frete = (pesoParaCobranca * distancia * taxaPorKm).toFixed(2);

        resultado.innerHTML = `
          <strong>Medida:</strong> ${medida}<br>
          <strong>Dimensões do pneu:</strong><br>
          Largura: ${larguraCm.toFixed(1)} cm<br>
          Altura: ${altura.toFixed(1)} mm<br>
          Diâmetro: ${diametroTotal.toFixed(1)} cm<br>
          Volume: ${volume.toFixed(2)} L<br>
          Peso estimado: ${pesoEstimado.toFixed(1)} kg<br>
          Peso cubado: ${pesoCubado.toFixed(1)} kg<br><br>
          <strong>Distância real:</strong> ${distancia.toFixed(1)} km<br>
          <strong>Frete estimado:</strong> R$ ${frete}
        `;
      });
    }

    document.getElementById('btnCalcular').addEventListener('click', calcularFrete);
  </script>
</body>
</html>
