<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Calculadora de Frete de Pneus</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f8f9fa;
      color: #333;
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }
    h2 {
      text-align: center;
      color: #2c3e50;
    }
    .card {
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-top: 20px;
    }
    label {
      margin-top: 10px;
      font-weight: bold;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    button {
      background: #3498db;
      color: white;
      font-weight: bold;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #2980b9;
    }
    .resultado {
      margin-top: 20px;
      background: #ecf0f1;
      border-left: 5px solid #3498db;
      padding: 15px;
      font-size: 14px;
    }
    .erro {
      color: red;
      font-weight: bold;
    }
  </style>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCKCV0EeLhjGGkio1-FrkBTbVBk-rP3Q74"></script>
</head>
<body>
  <h2>Calculadora de Frete de Pneus</h2>
  <div class="card">
    <label for="medida">Selecione a Medida do Pneu:</label>
    <select id="medida">
      <option value="">-- Escolha uma medida --</option>
      <optgroup label="Aro 13">
        <option>165/70R13</option>
        <option>175/70R13</option>
        <option>175/75R13</option>
        <option>185/70R13</option>
      </optgroup>
      <optgroup label="Aro 14">
        <option>165/60R14</option>
        <option>175/70R14</option>
        <option>185/60R14</option>
        <option>185/70R14</option>
      </optgroup>
      <optgroup label="Aro 15">
        <option>175/65R15</option>
        <option>185/60R15</option>
        <option>195/65R15</option>
        <option>205/60R15</option>
      </optgroup>
    </select>

    <label for="origem">CEP de Origem:</label>
    <input type="text" id="origem" placeholder="00000000" maxlength="9">

    <label for="destino">CEP de Destino:</label>
    <input type="text" id="destino" placeholder="00000000" maxlength="9">

    <button id="btnCalcular">Calcular Frete</button>

    <div class="resultado" id="resultado"></div>
  </div>

  <script>
    function formatarCEP(cep) {
      return cep.replace(/[^0-9]/g, '') + ', Brasil';
    }

    function calcularDistanciaReal(origem, destino, callback) {
      const service = new google.maps.DistanceMatrixService();
      service.getDistanceMatrix({
        origins: [formatarCEP(origem)],
        destinations: [formatarCEP(destino)],
        travelMode: 'DRIVING',
        unitSystem: google.maps.UnitSystem.METRIC,
      }, function(response, status) {
        if (status === 'OK') {
          const elemento = response.rows[0].elements[0];
          if (elemento.status === 'OK') {
            const distanceKm = elemento.distance.value / 1000;
            callback(null, distanceKm);
          } else {
            callback('Distância não encontrada.', null);
          }
        } else {
          callback('Erro na API: ' + status, null);
        }
      });
    }

    function calcularFrete() {
      const medida = document.getElementById('medida').value;
      const origem = document.getElementById('origem').value;
      const destino = document.getElementById('destino').value;
      const resultado = document.getElementById('resultado');

      if (!medida || !origem || !destino) {
        resultado.innerHTML = '<span class="erro">Por favor, preencha todos os campos corretamente.</span>';
        return;
      }

      const match = medida.match(/(\d{3})\/(\d{2})R(\d{2})/);
      if (!match) {
        resultado.innerHTML = '<span class="erro">Medida inválida.</span>';
        return;
      }

      const largura = parseInt(match[1]);
      const perfil = parseInt(match[2]);
      const aro = parseInt(match[3]);

      const altura = (largura * (perfil / 100));
      const diametroTotal = ((2 * altura) + (aro * 25.4)) / 10;
      const larguraCm = largura / 10;

      const volume = Math.PI * Math.pow((diametroTotal / 2), 2) * larguraCm / 1000;
      const pesoEstimado = largura * 0.02;
      const pesoCubado = (diametroTotal * diametroTotal * larguraCm) / 6000;
      const pesoParaCobranca = Math.max(pesoEstimado, pesoCubado);
      const pesoTotal = pesoParaCobranca * 4;

      calcularDistanciaReal(origem, destino, function(erro, distancia) {
        if (erro) {
          resultado.innerHTML = '<span class="erro"><strong>Erro:</strong> ' + erro + '</span>';
          return;
        }

        const freteTotal = pesoTotal * 3.0;
        const freteUnitario = (freteTotal / 4).toFixed(2);

        resultado.innerHTML = `
          <strong>Medida:</strong> ${medida}<br>
          <strong>Dimensões do pneu:</strong><br>
          Largura: ${larguraCm.toFixed(1)} cm<br>
          Altura: ${altura.toFixed(1)} mm<br>
          Diâmetro: ${diametroTotal.toFixed(1)} cm<br>
          Volume: ${volume.toFixed(2)} L<br>
          Peso estimado por pneu: ${pesoParaCobranca.toFixed(1)} kg<br><br>
          <strong>Distância real:</strong> ${distancia.toFixed(1)} km<br>
          <strong>Frete total (4 pneus):</strong> R$ ${freteTotal.toFixed(2)}<br>
          <strong>Frete por pneu (unitário):</strong> R$ ${freteUnitario}
        `;
      });
    }

    document.getElementById('btnCalcular').addEventListener('click', calcularFrete);
  </script>
</body>
</html>
